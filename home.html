<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Services</title>
  <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="index.css">
</head>
<body>
  <section class="centered-section">
    <header>
      <nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800">
          <div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl">
              <a href="https://flowbite.com" class="flex items-center">
                  <img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo" />
                  <span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">TrainVoyage</span>
              </a>
              <div class="flex items-center lg:order-2">
                  <a href="login.html" class="text-gray-800 dark:text-white hover:bg-gray-50 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-4 lg:px-5 py-2 lg:py-2.5 mr-2 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">Log Out</a>
                  <a href="#" class="text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 font-medium rounded-lg text-sm px-4 lg:px-5 py-2 lg:py-2.5 mr-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800">Get started</a>
                  <button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false">
                      <span class="sr-only">Open main menu</span>
                      <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                      <svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                  </button>
              </div>
              <div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2">
                  <ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0">
                      <li>
                          <a href="#" class="block py-2 pr-4 pl-3 text-white rounded bg-primary-700 lg:bg-transparent lg:text-primary-700 lg:p-0 dark:text-white" aria-current="page">Home</a>
                      </li>
                      <li>
                        <a id="admin-link" href="#" class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-primary-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700">
                            Admin
                        </a>
                    </li>
                    
                     
                  </ul>
              </div>
          </div>
      </nav>
  </header>
    <div class="welcome-content w-full">
      <section>
        <div class="first">

          <div class="w-full flex flex-col items-center p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
            <a href="#" class="flex items-center justify-center flex-col">
                <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">Number of ticket booked per class:</h5>
                <h6 class="mb-2 text-xl/2 font-bold tracking-tight text-gray-900 dark:text-white">Sleeper:<span class="font-bold text-gray-600 ">20</span></h6>
                <h6 class="mb-2 text-xl/2 font-bold tracking-tight text-gray-900 dark:text-white">AC1:<span class="font-bold text-gray-600 ">20</span></h6>
            </a>
            <p class="mb-3 text-xl font-semibold text-gray-700 dark:text-gray-400">Sales done per quarter: <span class="font-bold text-gray-600 text-2xl">500</span></p>
            
          </div>
        </div>

      </section>
      <section class="flex items-center justify-center mt-10 gap-5">
        <div class="second">
          

            <div class="max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
              <a href="#">
                  <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">Book Ticket</h5>
              </a>
              <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">Easily book your train tickets for seamless travel experiences.</p>
              <a data-modal-target="authentication-modal" data-modal-toggle="authentication-modal" href="#" class=" block text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800 inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                  Book Now
                  <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                      <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                  </svg>
              </a>



<!-- Main modal -->
<div id="authentication-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative p-4 w-full max-w-md max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
            <!-- Modal header -->
            <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                    Book Your Ticket Now!
                </h3>
                <button type="button"  class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="authentication-modal">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="p-4 md:p-3" id="main-modal">
                <form class="space-y-2 " action="#" id="SearchTrainsForm">
                    <div>
                        <input type="text" name="ID" id="id" placeholder="Enter your ID" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" placeholder="name@company.com" required />
                    </div>
                    <div>
                        <input type="text" name="name" id="name" placeholder="Enter your name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                    <div>
                      <input type="text" name="age" id="age" placeholder="Enter your age" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                    <div>
                      <input type="number" name="mobile" id="mobile" placeholder="Enter your Phone" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                    <div>
                      <input type="text" name="boarding" id="boaring" placeholder="Enter your boarding station" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                    <div>
                      <input type="text" name="designation" id="designation" placeholder="Enter your designation station" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                   
                    <div>
                      <input type="date" name="date" id="date" placeholder="Enter your journey date" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                    </div>
                    <select name="class" id="class" class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white">
                      <option value="Sleeper">Sleeper</option>
                      <option value="AC1">AC Tier 1</option>
                      <option value="AC2">AC Tier 2</option>
                      <option value="AC3">AC Tier 3</option>
                      <option value="Tatkal">Tatkal</option>
                    </select>
                    
                    <button type="submit" class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Search Trains...</button>
                    
                </form>
                <div class="p-4 md:p-3" id="main-modal-2">
                  <div id="findTrains"></div>
                </div>

            </div>

            <!-- <div class="p-4 md:p-3" id="main-modal-2">
              <div id="findTrains"></div>
            </div> -->
        </div>
    </div>
</div> 

            </div>

        </div>
        <div class="third ">
          

            <div class="max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
              <a href="#">
                  <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">View Ticket</h5>
              </a>
              <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">Quickly view your ticket details and journey information here.</p>
              <a data-modal-target="view-tickets-modal" data-modal-toggle="view-tickets-modal" href="#" onclick="viewTickets(new URLSearchParams(window.location.search).get('e'))" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                View
                <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                </svg>
            </a>


              <!-- view modal -->
               <!-- View Tickets Modal -->
               <div id="view-tickets-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                <div class="relative p-4 w-full max-w-md max-h-full">
                    <!-- Modal content -->
                    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                        <!-- Modal header -->
                        <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                                Your Tickets!
                            </h3>
                            <button type="button"  class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="view-tickets-modal">
                              <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                              </svg>
                              <span class="sr-only">Close modal</span>
                          </button>
                        </div>
                        <!-- Modal body -->
                        <div class="p-4 md:p-3" id="ticket-list">
                          
                      </div>
                    </div>
                </div>
            </div> 


            </div>

        </div>
        <div class="fourth ">
          

          <div class="max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
            <a href="#">
                <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white">Update Details</h5>
            </a>
            <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">Manage your profile and personal details in one convenient place.</p>
            <a data-modal-target="update-modal" onclick="openUpdateModal(new URLSearchParams(window.location.search).get('e'))" data-modal-toggle="update-modal" href="#" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                Update
                <svg class="rtl:rotate-180 w-3.5 h-3.5 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
                </svg>
            </a>

            <!-- update modal -->
            <div id="update-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
              <div class="relative p-4 w-full max-w-md max-h-full">
                  <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                      <!-- Modal header -->
                      <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                          <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Update User Information</h3>
                          <button type="button"  class="end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="update-modal">
                              <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                              </svg>
                              <span class="sr-only">Close modal</span>
                          </button>
                      </div>
          
                      <!-- Modal body -->
                      <div class="p-4 md:p-3" id="user-information-update">
                          <form id="userUpdateForm" class="space-y-2">
                  
                              <div>
                                  <label for="userName" class="block mb-2 text-sm font-medium text-gray-700">UserName</label>
                                  <input type="text" id="userName" name="userName" placeholder="Enter your name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                              </div>
                              <div>
                                  <label for="userEmail" class="block mb-2 text-sm font-medium text-gray-700">Email</label>
                                  <input type="email" id="userEmail" name="userEmail" placeholder="Enter your email" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                              </div>
                              <div>
                                  <label for="userMobile" class="block mb-2 text-sm font-medium text-gray-700">Mobile</label>
                                  <input type="tel" id="userMobile" name="userMobile" placeholder="Enter your phone number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white" required />
                              </div>
                              <button type="submit" class="w-full text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Update Information</button>
                          </form>
                      </div>
                  </div>
              </div>
          </div>
          </div>

        </div>
      </section>
    </div>


    <div class="relative">
      

<footer class= " fixed bottom-0 w-full rounded-lg shadow m-4 dark:bg-gray-800">
  <div class="w-full mx-auto max-w-screen-xl p-4 md:flex md:items-center md:justify-between">
    <span class="text-sm text-gray-500 sm:text-center dark:text-gray-400">Â© 2024 <a href="#" class="hover:underline">TrainVoyage</a>. All Rights Reserved.
  </span>
  <ul class="flex flex-wrap items-center mt-3 text-sm font-medium text-gray-500 dark:text-gray-400 sm:mt-0">
      <li>
          <a href="#" class="hover:underline me-4 md:me-6">About</a>
      </li>
      <li>
          <a href="#" class="hover:underline me-4 md:me-6">Privacy Policy</a>
      </li>
      <li>
          <a href="#" class="hover:underline me-4 md:me-6">Licensing</a>
      </li>
      <li>
          <a href="#" class="hover:underline">Contact</a>
      </li>
  </ul>
  </div>
</footer>

    </div>
</section>
<script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>
<!-- <script src="index.js"></script> -->
<script>
  const searchTrains = document.getElementById("SearchTrainsForm"); 
// const AllTrains = [
//     {
//         'Boarding': 'Delhi',
//         'Designation': 'Mumbai',
//         'Date':'20-12-2024',
//         'Train':'Jan Shatabdi Express',
//         'Ticket': 500,
//         'Class':'AC1',
//     },
//     {
//         'Boarding': 'Delhi',
//         'Designation': 'Goa',
//         'Date':'21-12-2024',
//         'Train':'Rajdhani Express',
//         'Ticket':1000,
//         'Class':'Tatkal'
//     }
// ]

const AllTrains = JSON.parse(localStorage.getItem('registeredTrains'));
console.log(AllTrains);
searchTrains.addEventListener('submit', function(event){
    event.preventDefault();
    const ID = document.getElementById('id').value;
    const name = document.getElementById('name').value;
    const age = document.getElementById('age').value;
    const mobile = document.getElementById('mobile').value;
    const boarding = document.getElementById('boaring').value;
    const date = document.getElementById('date').value;
    const designation = document.getElementById('designation').value;
    const category = document.getElementById('class').value;
    const findTrainsDiv = document.getElementById('findTrains');
    if(ID.trim() == "" || name.trim()=="" || age.trim()=="" || mobile.trim()=="" || boarding.trim()=="" || designation.trim()=="" || category.trim()==""){
        alert("please fill all required details");
    }
    const trains = Array.isArray(AllTrains) && AllTrains.filter(item=>{
        if(item.Boarding.toLocaleLowerCase() == boarding.toLocaleLowerCase() && item.Designation.toLocaleLowerCase() == designation.toLocaleLowerCase()){
            return true;
        }
    })
    console.log(date);
    if(trains.length>0){
      searchTrains.style.display = 'none';

      findTrainsDiv.innerHTML = trains.map(train => `
    <div class="flex justify-between items-center mb-4 p-4 border rounded-lg shadow">
        <div>
            <h3 class="text-lg font-bold">Train: ${train.Train}</h3>
            <p>Boarding: ${train.Boarding}</p>
            <p>Destination: ${train.Designation}</p>
            <p>Date: ${date}</p>
            <p>Ticket Price: ${train.Ticket}</p>
            <p>Class: ${train.Class}</p>
            <div class="mt-2">
                <label for="ticketCount-${train.Train}" class="block mb-1 text-sm font-medium text-gray-700 dark:text-gray-400">Number of Tickets</label>
                <input id="ticketCount-${train.Train}" type="number" min="1" value="1" class="w-16 px-2 py-1 border rounded-lg text-sm" />
            </div>
        </div>
        <div>
            <button onclick="bookTicket('${train.Train}', '${train.Boarding}', '${train.Designation}', '${date}', '${train.Ticket}','${new URLSearchParams(window.location.search).get('e')}', '${train.Class}')" class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                Book
            </button>
        </div>
    </div>
`).join('');


    }
    else{
      findTrainsDiv.innerHTML = '<p>No trains found for the provided details.</p>';
    }

})

function bookTicket(train, boarding, destination, date, price, userEmail,category) {
    const ticketCount = document.getElementById(`ticketCount-${train}`).value;
    
    
    let user = JSON.parse(localStorage.getItem(userEmail));
    
    if (!user) {
        alert("User not found in local storage.");
        return;
    }
    
    
    const ticketDetails = {
        train: train,
        boarding: boarding,
        destination: destination,
        date: date,
        price: price*ticketCount,
        Class: category,
        ticketCount: ticketCount
    };
    
    
    if (!user.tickets) {
        user.tickets = [];
    }
    
    // console.log(ticketDetails);
    user.tickets.push(ticketDetails);
    
    
    localStorage.setItem(userEmail, JSON.stringify(user));
    
    alert("Ticket booked successfully!");
    const modal = document.getElementById('authentication-modal');
    if (modal) {
        modal.classList.add('hidden'); 
    }
    window.location.reload();


}

</script>
<script>
  function viewTickets(userEmail) {
            // console.log(userEmail);
            const modal = document.getElementById('view-tickets-modal');
            const ticketList = document.getElementById('ticket-list');

            // Fetch user data from local storage
            let user = JSON.parse(localStorage.getItem(userEmail));

            if (!user || !user.tickets || user.tickets.length === 0) {
                ticketList.innerHTML = '<p>No tickets found.</p>';
            } else {
                // Display each ticket
                ticketList.innerHTML = user.tickets.map((ticket, index) => `
                    <div class="mb-4 p-4 border rounded-lg shadow">
                        <h4 class="text-lg font-bold">Train: ${ticket.train}</h4>
                        <p>Boarding: ${ticket.boarding}</p>
                        <p>Destination: ${ticket.destination}</p>
                        <p>Date: ${ticket.date}</p>
                        <p>Tickets: ${ticket.ticketCount}</p>
                        <p>Price: ${ticket.price}</p>
                        <button onclick="deleteTicket(${index}, '${userEmail}')" class="mt-2 text-sm text-white bg-red-600 hover:bg-red-700 px-3 py-1 rounded-lg">
                            Delete Ticket
                        </button>
                    </div>
                `).join('');
            }

            // Show the modal
            modal.classList.remove('hidden');
        }

//     function closeModal(modalId) {
//     const modal = document.getElementById(modalId);
//     modal.classList.add('hidden');
// }


function deleteTicket(ticketIndex, userEmail) {
    let user = JSON.parse(localStorage.getItem(userEmail));

    if (!user || !user.tickets || user.tickets.length === 0) {
        alert('No tickets found to delete.');
        return;
    }

    // Remove the ticket from the list
    user.tickets.splice(ticketIndex, 1);

    // Update local storage
    localStorage.setItem(userEmail, JSON.stringify(user));

    // Refresh the tickets list
    viewTickets(userEmail);
    alert('Ticket deleted successfully.');
}

  </script>

  
  <script>
    
function openUpdateModal(email) {
  
    const user = JSON.parse(localStorage.getItem(email));
    
    if (user) {
        // console.log(user);
        document.getElementById('userName').value = user.username || '';  
        document.getElementById('userEmail').value = user.email || ''; 
        document.getElementById('userMobile').value = user.contact || '';  

        const modal = document.getElementById('update-modal');
        if (modal) {
            modal.classList.remove('hidden'); 
        }
    } else {
        alert("User not found!");
    }
}


function updateUserInfo(email) {
  // console.log(email);
    
    const userName = document.getElementById('userName').value;
    const userEmail = document.getElementById('userEmail').value;
    const userMobile = document.getElementById('userMobile').value;

    
    let user = JSON.parse(localStorage.getItem(email));
    
    if (user) {
       
        user.username = userName;
        user.email = userEmail;
        user.contact = userMobile;

        localStorage.setItem(email, JSON.stringify(user));
        alert("User information updated successfully!");
        
    } else {
        alert("User not found!");
    }
}

// Add event listener for form submission
document.getElementById('userUpdateForm').addEventListener('submit', function(event) {
    event.preventDefault(); 
    updateUserInfo(new URLSearchParams(window.location.search).get('e'));
});

    </script>
    <script>
      window.addEventListener('DOMContentLoaded', (event) => {
          const email = new URLSearchParams(window.location.search).get('e');
          const adminLink = document.getElementById('admin-link');
          if (email) {
              adminLink.href = `admin.html?e=${encodeURIComponent(email)}`;
          }
      });
  </script>
</body>
</html>

